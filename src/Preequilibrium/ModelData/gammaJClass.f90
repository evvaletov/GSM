
module gammaJClass
! Calculates/fits gamma_beta
! Written by L. Kerby, 2/2013, modified 04/2015
! Edited by C. Juneau, 8/2018 (migrated to class framework)
!
!
! 66 particle index for fragment:
! 1 = n
! 2 = p
! 3 = d
! 4 = t
! 5 = He3
! 6 = He4
! 7 = He6
! 8 = He8
! 9 = Li6
! 10 = Li7
! 11 = Li8
! 12 = Li9
! 13 = Be7
! 14 = Be9
! 15 = Be10
! 16 = Be11
! 17 = Be12
! 18 = B8
! 19 = B10
! 20 = B11
! 21 = B12
! 22 = B13
! 23 = C10
! 24 = C11
! 25 = C12
! 26 = C13
! 27 = C14
! 28 = C15
! 29 = C16
! 30 = N12
! 31 = N13
! 32 = N14
! 33 = N15
! 34 = N16
! 35 = N17
! 36 = O14
! 37 = O15
! 38 = O16
! 39 = O17
! 40 = O18
! 41 = O19
! 42 = O20
! 43 = F17
! 44 = F18
! 45 = F19
! 46 = F20
! 47 = F21
! 48 = Ne18
! 49 = Ne19
! 50 = Ne20
! 51 = Ne21
! 52 = Ne22
! 53 = Ne23
! 54 = Ne24
! 55 = Na21
! 56 = Na22
! 57 = Na23
! 58 = Na24
! 59 = Na25
! 60 = Mg22
! 61 = Mg23
! 62 = Mg24
! 63 = Mg25
! 64 = Mg26
! 65 = Mg27
! 66 = Mg28
!

  use, intrinsic :: iso_fortran_env, only: real64
  use preequilibriumData, only: numAllowedFragments

  implicit none
  private


  ! For divide by zero errors:
  real(real64), private, parameter :: div0Lim = 1.0d-15


  ! Class constructor
  public :: GammaJ
  interface GammaJ
     module procedure :: new_GammaJ   ! Initialized and sets particular values for F_j
  end interface GammaJ

  ! Class definition
  type, public :: GammaJ
     private
     real(real64), private, dimension(numAllowedFragments) :: F_j  = 1.0_real64  ! Coefficient for gammaBeta calculation
   contains
     private
     procedure, public :: getGammaBeta   ! Obtains Gamma_Beta multiplier
  end type GammaJ


CONTAINS

! ==============================================================================

  SUBROUTINE getGammaBeta( gammaJObj, Num_Preeq_Part, A_residual, Gamma_B)

! ==============================================================================
!
! Calculates gamma_j given the F_j values calculated in new_GammaJ
! Called from precof.f90, for each event
! 
! ==============================================================================

    use, intrinsic :: iso_fortran_env, only: int32, real64
    use preequilibriumData, only: A_fragment => aj, numAllowedFragments

    implicit none
    class(GammaJ),  intent(in)  :: gammaJObj
    integer(int32), intent(in)  :: Num_Preeq_Part
    real(real64),   intent(in)  :: A_residual
    real(real64),   intent(out) :: Gamma_B(numAllowedFragments)

    integer(int32) :: i, A_f_int, i_start
    real(real64)   :: temp

! ==============================================================================
    i_start=3    ! Use Fj Model for all complex fragments for all reaction types 
                 ! (improves d, t, He3, and He4 spectra of gamma- and pion-induced reactions)

    if (Num_Preeq_Part > 2) then
       do i = i_start, Num_Preeq_Part    
          A_f_int = nint( A_fragment(i) ) - 1
          temp = A_residual
          if (temp < div0Lim .and. temp > -div0Lim) then
             temp = div0Lim
             write(*,1000) "112"
          end if
          Gamma_B(i) = gammaJObj%F_j(i) * (A_fragment(i)**3) * (A_fragment(i)/temp)**A_f_int   ! from d to (Mg-28)
       end do
    end if

    ! LMK 07/2012: Fill remaining of Gamma_B() array with 0's (for particles above Num_Preeq_Part)
    if ( Num_Preeq_Part < numAllowedFragments ) then
       do i = (Num_Preeq_Part+1), numAllowedFragments
          Gamma_B(i) = 0
       end do
    end if

    return
! ==============================================================================
1000 format(3x, "Warning: Divide by zero error prevented in ", &
          & "'gamma_j_mod.f90', line ", A)
! ==============================================================================
  END SUBROUTINE getGammaBeta


  function new_GammaJ( T0_mev, A_target, A_projectile, Z_projectile) &
       & result(gammaJObj)
! ==============================================================================
! Initializes F_j array, called once at the beginning of gsm03.f90
!
! Written by L. Kerby (LMK), 2/2013, modified 04/2015 (by LMK)
! Edited by CMJ, XCP-3, 7/17 (LAQGSM Expansion) - F_j only needs allocated once
!
! ==============================================================================

    use, intrinsic :: iso_fortran_env, only: int32, real64
    use preequilibriumData, only: A_fragment => aj, Z_fragment => zj, &
         & Num_Preeq_Part => numAllowedFragments

    implicit none
    real(real64),     intent(in) :: T0_mev
    real(real64),     intent(in) :: A_target
    integer(int32),   intent(in) :: A_projectile
    integer(int32),   intent(in) :: Z_projectile

    type(GammaJ)                 :: gammaJObj

    integer(int32) :: i
    real(real64)   :: tau

! ==============================================================================

    ! Set F_j scaling factors based on projectile data and incident energy
    if ( A_projectile == 1 .and. Z_projectile == 1 ) then
       ! General case for incident protons
       do i=8,Num_Preeq_Part    ! Start at He8
          tau = A_fragment(i) - (Z_fragment(i) - 3.)
          gammaJObj%F_j(i) = ( 7800.*(2.5**A_fragment(i))*exp(-T0_mev/20.) + 2.*(4.**nint(tau))/(T0_mev**(0.2*tau)+100.) ) * &
               ( exp(-(300.-A_target)/100.) )
       end do

       ! Specific fragments
       gammaJObj%F_j(3) = (-3.*exp(-(T0_mev)/20.) + 125./(T0_mev**(0.2)+100.))    ! d
       gammaJObj%F_j(4) = (20.*exp(-(T0_mev)/20.) + 175./(T0_mev**(0.4)+100.))    ! t
       gammaJObj%F_j(5) = (20.*exp(-(T0_mev)/20.) + 250./(T0_mev**(0.6)+100.))    ! He3
       gammaJObj%F_j(6) = (100.*exp(-(T0_mev)/20.) + 1000./(T0_mev**(0.8)+100.))    ! He4
       gammaJObj%F_j(7) = (140000.*exp(-(T0_mev)/20.) + 1400./(T0_mev**(1.2)+100.)) * ( exp(-(300.-A_target)/100.) )    ! He6
       gammaJObj%F_j(9) = (400000.*exp(-(T0_mev)/20.) + 5000./(T0_mev**(1.2)+100.)) * ( exp(-(300.-A_target)/100.) )    ! Li6
       gammaJObj%F_j(10) = (1000000.*exp(-(T0_mev)/20.) + 25000./(T0_mev**(1.4)+100.)) * ( exp(-(300.-A_target)/100.) )    ! Li7
       gammaJObj%F_j(11) = (2500000.*exp(-(T0_mev)/20.) + 100000./(T0_mev**(1.6)+100.)) * ( exp(-(300.-A_target)/100.) )    ! Li8
       gammaJObj%F_j(12) = (6250000.*exp(-(T0_mev)/20.) + 400000./(T0_mev**(1.8)+100.)) * ( exp(-(300.-A_target)/100.) )    ! Li9
       gammaJObj%F_j(13) = (1000000.*exp(-(T0_mev)/20.) + 5000./(T0_mev**(1.2)+100.)) * ( exp(-(300.-A_target)/100.) )        ! Be7
       gammaJObj%F_j(14) = (6250000.*exp(-(T0_mev)/20.) + 100000./(T0_mev**(1.6)+100.)) * ( exp(-(300.-A_target)/100.) )    ! Be9
       gammaJObj%F_j(15) = (15625000.*exp(-(T0_mev)/20.) + 400000./(T0_mev**(1.8)+100.)) * ( exp(-(300.-A_target)/100.) )    ! Be10
       gammaJObj%F_j(19) = (15625000.*exp(-(T0_mev)/20.) + 150000./(T0_mev**(1.6)+100.)) * ( exp(-(300.-A_target)/100.) )    ! B10
       gammaJObj%F_j(20) = (39000000.*exp(-(T0_mev)/20.) + 600000./(T0_mev**(1.8)+100.)) * ( exp(-(300.-A_target)/100.) )    ! B11
       gammaJObj%F_j(21) = (97500000.*exp(-(T0_mev)/20.) + 2400000./(T0_mev**(2.0)+100.)) * ( exp(-(300.-A_target)/100.) )    ! B12
       gammaJObj%F_j(25) = (97500000.*exp(-(T0_mev)/20.) + 600000./(T0_mev**(1.8)+100.)) * ( exp(-(300.-A_target)/100.) )    ! C12
       gammaJObj%F_j(26) = (244000000.*exp(-(T0_mev)/20.) + 2400000./(T0_mev**(2.0)+100.)) * ( exp(-(300.-A_target)/100.) )    ! C13


    else if ( A_projectile == 1 .and. Z_projectile == 0 ) then

       ! General case for incident neutrons
       do i=8,Num_Preeq_Part    ! Start at He8
          tau = A_fragment(i) - (Z_fragment(i) - 3.)
          gammaJObj%F_j(i) = ( 7800.*(2.5**A_fragment(i))*exp(-T0_mev/20.) + 2.*(4.**nint(tau))/(T0_mev**(0.2*tau)+100.) ) * &
               ( exp(-(300.-A_target)/100.) )
       end do

       ! Specific fragments
       gammaJObj%F_j(3) = 1.5*(-3.*exp(-(T0_mev)/20.) + 125./(T0_mev**(0.2)+100.))    ! d
       gammaJObj%F_j(4) = 2.25*(-3.*exp(-(T0_mev)/20.) + 125./(T0_mev**(0.2)+100.))    ! t
       gammaJObj%F_j(5) = 1.5*(20.*exp(-(T0_mev)/20.) + 250./(T0_mev**(0.6)+100.))    ! He3
       gammaJObj%F_j(6) = 5.*(100.*exp(-(T0_mev)/20.) + 1000./(T0_mev**(0.8)+100.))    ! He4
       gammaJObj%F_j(7) = (140000.*exp(-(T0_mev)/20.) + 1400./(T0_mev**(1.2)+100.)) * ( exp(-(300.-A_target)/100.) )    ! He6
       gammaJObj%F_j(9) = (400000.*exp(-(T0_mev)/20.) + 5000./(T0_mev**(1.2)+100.)) * ( exp(-(300.-A_target)/100.) )    ! Li6
       gammaJObj%F_j(10) = (1000000.*exp(-(T0_mev)/20.) + 25000./(T0_mev**(1.4)+100.)) * ( exp(-(300.-A_target)/100.) )    ! Li7
       gammaJObj%F_j(11) = (2500000.*exp(-(T0_mev)/20.) + 100000./(T0_mev**(1.6)+100.)) * ( exp(-(300.-A_target)/100.) )    ! Li8
       gammaJObj%F_j(12) = (6250000.*exp(-(T0_mev)/20.) + 400000./(T0_mev**(1.8)+100.)) * ( exp(-(300.-A_target)/100.) )    ! Li9
       gammaJObj%F_j(13) = (1000000.*exp(-(T0_mev)/20.) + 5000./(T0_mev**(1.2)+100.)) * ( exp(-(300.-A_target)/100.) )        ! Be7
       gammaJObj%F_j(14) = (6250000.*exp(-(T0_mev)/20.) + 100000./(T0_mev**(1.6)+100.)) * ( exp(-(300.-A_target)/100.) )    ! Be9
       gammaJObj%F_j(15) = (15625000.*exp(-(T0_mev)/20.) + 400000./(T0_mev**(1.8)+100.)) * ( exp(-(300.-A_target)/100.) )    ! Be10
       gammaJObj%F_j(19) = (15625000.*exp(-(T0_mev)/20.) + 150000./(T0_mev**(1.6)+100.)) * ( exp(-(300.-A_target)/100.) )    ! B10
       gammaJObj%F_j(20) = (39000000.*exp(-(T0_mev)/20.) + 600000./(T0_mev**(1.8)+100.)) * ( exp(-(300.-A_target)/100.) )    ! B11
       gammaJObj%F_j(21) = (97500000.*exp(-(T0_mev)/20.) + 2400000./(T0_mev**(2.0)+100.)) * ( exp(-(300.-A_target)/100.) )    ! B12
       gammaJObj%F_j(25) = (97500000.*exp(-(T0_mev)/20.) + 600000./(T0_mev**(1.8)+100.)) * ( exp(-(300.-A_target)/100.) )    ! C12
       gammaJObj%F_j(26) = (244000000.*exp(-(T0_mev)/20.) + 2400000./(T0_mev**(2.0)+100.)) * ( exp(-(300.-A_target)/100.) )    ! C13  
    else

       ! Photon, pion, or light/heavy-ion induced reactions (no scaling)
       ! gammaJObj%F_j = 1.0d0

    end if

    return
! ==============================================================================
  END function new_GammaJ


END MODULE gammaJClass

! F_j fits

!**************************** Proton-Induced Reactions***********************
! 28.8MeV p + Al27 (refit higher than He4 once have a better estimate...)
!  F_j = (/ 1.0, 1.0, 0.65, 4.0, 6.5, 5.0, 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! 28.8MeV p + Fe54 (refit higher than He4 once have a better estimate...)
!  F_j = (/ 1.0, 1.0, 0.5, 8.0, 8.0, 20.0, 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)


! 38.8MeV p + Fe54 (refit higher than He4 once have a better estimate...)
!  F_j = (/ 1.0, 1.0, 0.5, 0.55, 2.5, 4.5, 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! Just used F_j = 1.0
! 50MeV p + Cnat (using C12) (All Fermi break-up, impossible to fit with A<13 cutoff: fit He, Li, Be, B, C -- no isotopes)
!  F_j = (/ 1.0d0, 1.0d0, 1.0d0, 8.0d0, 8.0d0, 10.0d0, 5.0d0, 5.0d0, 20.0d0, 8.0d0, &
!    6.8d0, 40.0d0, 3.0d0, 2.0d0, 2.0d0, 2.0d0, 2.0d0, 2.0d0, 5.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0 /)

! 50MeV p + Al27 (fit He, Li, Be, B, C, N, O -- no isotopes)
!  F_j = (/ 1.0d0, 1.0d0, 1.0d0, 8.0d0, 8.0d0, 10.0d0, 750.0d0, 750.0d0, 1000.0d0, 1000.0d0, &    !TEST He6,8:750 (was 5.0d0)
!    1000.0d0, 1000.0d0, 100000.0d0, 100000.0d0, 100000.0d0, 100000.0d0, 100000.0d0, 1.0d0, 1.0d0, 1.0d0, &        !TEST Be:100,000 (was 1)
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0 /)

! 50MeV p + Sinat (using Si28) (fit He, Li, Be, B, C, N, O -- no isotopes)
!  F_j = (/ 1.0d0, 1.0d0, 1.0d0, 8.0d0, 8.0d0, 10.0d0, 5.0d0, 5.0d0, 10000.0d0, 10000.0d0, &
!    10000.0d0, 10000.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0 /)

! 61.5MeV p + Fe54 (refit higher than He4 once have a better estimate...)
!  F_j = (/ 1.0, 1.0, 0.43, 0.65, 0.95, 12.0, 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! Just used F_j = 1.0
! 70MeV p + Cnat (using C12) (All Fermi break-up, impossible to fit with A=12 cutoff: fit He, Li, Be, B, C -- no isotopes)
!  F_j = (/ 1.0d0, 1.0d0, 1.0d0, 8.0d0, 8.0d0, 10.0d0, 5.0d0, 5.0d0, 20.0d0, 8.0d0, &
!    6.8d0, 40.0d0, 3.0d0, 2.0d0, 2.0d0, 2.0d0, 2.0d0, 2.0d0, 5.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0 /)

! 70MeV p + Al27 (fit He, Li, Be, B, C, N, O, F -- no isotopes)
!  F_j = (/ 1.0d0, 1.0d0, 1.0d0, 8.0d0, 8.0d0, 10.0d0, 5.0d0, 5.0d0, 1000.0d0, 1000.0d0, &
!    1000.0d0, 1000.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0 /)

! 70MeV p + Sinat (fit He, Li, Be, B, C, N, O -- no isotopes)
!  F_j = (/ 1.0d0, 1.0d0, 1.0d0, 8.0d0, 8.0d0, 10.0d0, 5.0d0, 5.0d0, 10000.0d0, 10000.0d0, &
!    10000.0d0, 10000.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, &
!    1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0, 1.0d0 /)

! 200MeV p + Al27 (fit to B10)
!  F_j = (/ 1.0, 1.0, 2.0, 4.0, 6.5, 19., 1.8, 1., 13., 3.8, &
!    4.5, 4.5, 4.5, 7., 13., 13., 13., 13., 13., 7., &
!    7., 7., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! 200MeV p + Co59 (fit to C13)
!  F_j = (/ 1.0, 1.0, 1.0, 2.0, 1.2, 3.0, 0.6, 1., 3.4, 7.5, &
!    16., 225., 7.5, 90., 1400., 4300., 4300., 5000., 5000., 15000., &
!    210000., 70000., 700000., 700000., 700000., 700000., 700000., 700000., 700000., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)


! 200MeV p + Au197 (fit to C13)
! F_j = (/ 1.0, 1.0, 1.0, 2.0, 1.0, 8.0, 6., 1., 13., 125., &
!    225., 450., 22., 1600., 13000., 13000., 13000., 13000., 21500., 140000., &
!    2100000., 200000., 7000000., 7000000., 4600000., 21000000., 7000000., 7000000., 7000000., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! 190MeV p + Ag107 
!  F_j = (/ 1.0, 1.0, 1.0, 1.0, 0.4, 2.5, 0.5, 1., 1.6, 6.5, &
!    13., 225., 6.2, 30., 400., 400., 400., 500., 500., 1500., &
!    21000., 7000., 70000., 70000., 70000., 70000., 70000., 70000., 70000., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! 190MeV p + Ag(natural, approx half 107 and half 109) ***OLD***
! F_j = (/ 1.0, 1.0, 1.0, 1.0, 0.4, 2.0, 0.25, 1., 1.4, 5., &
!    3.3, 5., 2.0, 32., 20., 3., 3., 2.5, 2.5, 2.5, &
!    2.5, 2.5, 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! 300MeV p + Ag(natural, approx half 107 and half 109)
!  F_j = (/ 1.0, 1.0, 1.0, 0.75, 1.0, 2.6, 2., 2., 1.4, 5., &
!    3.3, 5., 2.0, 5.5, 10., 3., 3., 2.5, 2.5, 2.5, &
!    2.5, 2.5, 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! 480MeV p + Ag(natural, approx half 107 and half 109)
!  F_j = (/ 1.0, 1.0, 2.0, 4.0, 0.7, 1., 2., 2., 0.3, 0.7, &
!    1.3, 0.5, 1., 0.5, 1.3, 1.3, 1.3, 0.25, 0.25, 0.25, &
!    0.25, 0.25, 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! Just used F_j = 1.0
! 660MeV p + B10 (useless to fit, fit to He4)
!  F_j = (/ 1.0d0, 1.0d0, 2.0d0, 4.0d0, 20.0d0, 30.0d0, 1.0d0, 1.0d0, 5.0d0, 2.0d0, &
!    1.7d0, 10.0d0, 0.3d0, 0.2d0, 0.2d0, 0.2d0, 0.2d0, 0.2d0, 2.0d0, 0.1d0, &
!    0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, &
!    0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, &
!    0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, &
!    0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, &
!    0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0 /)

! Just used F_j = 1.0
! 660MeV p + B11 (useless to fit, fit to He4)
!  F_j = (/ 1.0d0, 1.0d0, 2.0d0, 4.0d0, 20.0d0, 30.0d0, 1.0d0, 1.0d0, 5.0d0, 2.0d0, &
!    1.7d0, 10.0d0, 0.3d0, 0.2d0, 0.2d0, 0.2d0, 0.2d0, 0.2d0, 2.0d0, 0.1d0, &
!    0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, &
!    0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, &
!    0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, &
!    0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, &
!    0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0, 0.1d0 /)

! 660MeV p + Ni58 (fit to He4)
!  F_j = (/ 1.0, 1.0, 2.0, 4.0, 3.5, 16.0, 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! 660MeV p + Ni64 (fit to He4)
!  F_j = (/ 1.0, 1.0, 2.0, 4.0, 2.3, 7.0, 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! 660MeV p + Sn112 (fit to He4)
!  F_j = (/ 1.0, 1.0, 2.0, 4.0, 4.0, 40.0, 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! 660MeV p + Sn124 (fit to He4)
!  F_j = (/ 1.0, 1.0, 2.0, 4.0, 4.0, 40.0, 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! 1200MeV p + 61Ni 
!  F_j = (/ 1.0, 1.0, 3.0, 3.0, 4.5, 6.0, 0.01, 1.0, 0.7, 1.2, &
!    0.3, 0.06, 1.2, 0.16, 0.16, 0.16, 0.16, 0.25, 0.25, 0.08, &
!    0.05, 0.05, 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! 1900MeV p + 61Ni 
!  F_j = (/ 1.0, 1.0, 1.5, 2.0, 1.8, 2.4, 0.01, 0.5, 0.01, 0.12, &
!    0.14, 0.065, 0.17, 0.22, 0.2, 0.2, 0.2, 0.3, 0.3, 0.2, &
!    0.05, 0.1, 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! 2500MeV p + 61Ni 
!  F_j = (/ 1.0, 1.0, 2.0, 3.0, 5.0, 2.6, 0.01, 0.5, 0.01, 0.01, &
!    0.14, 0.065, 0.055, 0.22, 0.14, 0.2, 0.2, 0.3, 0.3, 0.1, &
!    0.030, 0.1, 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! 1200MeV p + Ta181 (fit to He4) 
!  F_j = (/ 1.0, 1.0, 0.3, 0.75, 0.2, 1.0, 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)


! 1200MeV p + 197Au 
!  F_j = (/ 1.0, 1.0, 0.5, 0.7, 0.4, 1.0, 0.1, 0.2, 0.18, 0.38, &
!    0.5, 0.17, 0.25, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! 1900MeV p + 197Au 
!  F_j = (/ 1.0, 1.0, 1.0, 0.95, 0.65, 0.95, 0.01, 0.1, 0.03, 0.25, &
!    0.21, 0.20, 0.08, 0.25, 0.45, 0.32, 0.32, 0.5, 0.40, 0.35, &
!    0.35, 0.35, 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)


! 2500MeV p + 197Au 
!  F_j = (/ 1.0, 1.0, 1.5, 1.2, 1.0, 0.7, 0.01, 0.5, 0.01, 0.12, &
!    0.13, 0.12, 0.065, 0.085, 0.14, 0.13, 0.13, 0.16, 0.16, 0.20, &
!    0.085, 0.085, 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

!**************************** Neutron-Induced Reactions***********************
! 41MeV n + Al27 (fit to He4)
!  F_j = (/ 1.0, 1.0, 0.9, 1.2, 5., 1000.0, 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! 49MeV n + Al27 (fit to He4)
!  F_j = (/ 1.0, 1.0, 1.6, 1.8, 5., 1000.0, 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! 62.7MeV n + Bi209 (fit to t)
!  F_j = (/ 1.0, 1.0, 1.38, 6.0, 5., 46.0, 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! 96MeV n + U238 (fit to He4)
!  F_j = (/ 1.0, 1.0, 2.5, 6.5, 5., 46.0, 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! 175MeV n + Fe56 (fit to He4)
!  F_j = (/ 1.0, 1.0, 3.5, 7.2, 6.8, 37.0, 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! 175MeV n + Bi209 (fit to He4)
!  F_j = (/ 1.0, 1.0, 2.5, 7.5, 5., 40.0, 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! 317MeV n + Cu63 (fit to t)
!  F_j = (/ 1.0, 1.0, 10., 9., 5., 20.0, 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! 317MeV n + Bi209 (fit to t)
!  F_j = (/ 1.0, 1.0, 2.4, 6.5, 5., 20.0, 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! 542MeV n + Cu63 (fit to t)
!  F_j = (/ 1.0, 1.0, 2.4, 0.85, 5., 10.0, 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

! 542MeV n + Bi209 (fit to t)
!  F_j = (/ 1.0, 1.0, 0.55, 0.45, 5., 10.0, 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., &
!    1., 1., 1., 1., 1., 1. /)

